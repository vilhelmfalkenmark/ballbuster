function startGame(){function a(){soundCounter++,soundCounter%2==0?(soundController.className="soundOnButton",toggleSoundText.innerHTML="Sound On"):(soundController.className="soundOffButton",toggleSoundText.innerHTML="Sound Off")}function b(){return time++,document.getElementById("timer").innerHTML=time,time%10===0&&(ammoLeft+=2),time}function c(){return frameCount++,frame.innerHTML=frameCount,frameCount}function d(a){a&&(soundCounter%2==0&&(damageSound.play(),healthBar.className=""),player.health--,E(player.health))}function e(){player.left&&(player.PositionValueX-=10,"shotgun"==typeOfShot?(strafeX=65*frameCount+585,frameCount>4&&(frameCount=0)):(strafeX=65*frameCount,frameCount>=4&&(frameCount=0))),player.right&&(player.PositionValueX+=10,"shotgun"==typeOfShot?(strafeX=65*frameCount+845,frameCount>4&&(frameCount=0)):(strafeX=65*frameCount+260,frameCount>=4&&(frameCount=0))),player.PositionValueX<0&&(player.PositionValueX=0),player.PositionValueX>playfieldWidth-player.width&&(player.PositionValueX=playfieldWidth-player.width)}function h(a,b,c,d,e){this.ballRadius=a,this.PositionValueX=b,this.PositionValueY=c,this.speedXAxis=d,this.speedYAxis=Math.round(Math.random()*ballSpeed+1),this.hexColorCode=g[e]}function k(a,b,c,d,e){bouncingBalls["ball"+i]=new h(a,b,c,d,e),i++}function l(a){a.PositionValueX+=a.speedXAxis,a.PositionValueY+=a.speedYAxis,playField.beginPath(),playField.fillStyle=a.hexColorCode,playField.arc(a.PositionValueX,a.PositionValueY,a.ballRadius,0,2*Math.PI,!0),playField.closePath(),playField.fill();var b=a.PositionValueX<a.ballRadius||a.PositionValueX>playfieldWidth-a.ballRadius,c=a.PositionValueY<a.ballRadius||a.PositionValueY>playfieldHeight-a.ballRadius-groundHeight,e=a.PositionValueY>playfieldHeight-player.height-a.ballRadius&&player.PositionValueX+player.width/2>a.PositionValueX-a.ballRadius&&player.PositionValueX+player.width/2<a.PositionValueX+a.ballRadius;b&&(a.speedXAxis=-a.speedXAxis),c&&(a.speedYAxis=-a.speedYAxis),e&&(hit=!0,d(hit))}function m(a,b){var c=a.PositionValueX-b.PositionValueX,d=a.PositionValueY-b.PositionValueY;return Math.sqrt(c*c+d*d)}function n(a,b){var c=m(a,b);return c<b.ballRadius}function o(a){"pistol"===a?ammoLeft>0&&(q(player.PositionValueX),ammoLeft--,soundCounter%2==0&&(shotSound.play(),shotSound.currentTime=0),strafeX=585):"shotgun"===a&&powerShotAvailabe>0&&(s(player.PositionValueX),powerShotAvailabe--,soundCounter%2==0&&(specialShotSound.play(),specialShotSound.currentTime=0),strafeX=650)}function q(a){var b={PositionValueX:a+11,PositionValueY:playfieldHeight-groundHeight-player.height-10,width:12,height:20,color:"black",img:shotImage};shotList["shot"+p]=b,player.health>0&&(p++,shotsFired.innerHTML=p),t()}function s(a){var b={id:1,PositionValueX:a+20,PositionValueY:playfieldHeight-groundHeight-player.height,width:10,height:10,img:specialShotImage},c={id:2,PositionValueX:a+10,PositionValueY:playfieldHeight-groundHeight-player.height,width:10,height:10,img:specialShotImage},d={id:3,PositionValueX:a+15,PositionValueY:playfieldHeight-groundHeight-player.height,width:10,height:10,img:specialShotImage};powerShotList["PowerShot"+r]=b,r++,powerShotList["PowerShot"+r]=c,r++,powerShotList["PowerShot"+r]=d,r++,specialShotsFired.innerHTML=r/3,t()}function t(){totalShotsFired.innerHTML=parseInt(specialShotsFired.innerHTML)+parseInt(shotsFired.innerHTML)}function u(a){a.PositionValueY-=22,1==a.id&&(a.PositionValueX-=5),2==a.id&&(a.PositionValueX+=5)}function v(a,b){for(var c in b){l(b[c]);for(var d in a){var e=n(a[d],b[c]);e?(soundCounter%2==0&&(pop.play(),pop.currentTime=0),60==b[c].ballRadius&&(k(mediumBallRadius,b[c].PositionValueX+20,b[c].PositionValueY,Math.random()*b[c].speedXAxis+1,1),k(mediumBallRadius,b[c].PositionValueX-20,b[c].PositionValueY,(Math.random()*b[c].speedXAxis+1)*-1,1)),40==b[c].ballRadius&&(k(smallBallRadius,b[c].PositionValueX+10,b[c].PositionValueY,Math.random()*b[c].speedXAxis+1,2),k(smallBallRadius,b[c].PositionValueX-10,b[c].PositionValueY,(Math.random()*b[c].speedXAxis+1)*-1,2)),delete b[c],delete a[d],f++,hitPerLevel++):a[d].PositionValueY<0&&delete a[d]}}}function w(a,b,c,d){this.width=a,this.height=b,this.type=c,this.img=d,this.PositionValueX=Math.floor(Math.random()*(playfieldWidth-30-this.width-this.width))+this.width,this.PositionValueY=playfieldHeight-this.height-groundHeight}function z(a,b,c,d){x["upgrade"+y]=new w(a,b,c,d),y++}function A(){x={}}function C(a){playField.drawImage(a.img,a.PositionValueX,a.PositionValueY)}function D(){ballCounter.innerHTML=Object.keys(bouncingBalls).length,playField.clearRect(0,0,playfieldWidth,playfieldHeight),player.health>100&&(player.health=100),healthBar.style.width=player.health+"%",collisionCounter.innerHTML=f;var a=(collisionCounter.innerHTML/totalShotsFired.innerHTML*100).toFixed(0);0==p&&0==r?accuracy.innerHTML=0:a<=100?accuracy.innerHTML=a:a>100&&(accuracy.innerHTML=100);var a=(collisionCounter.innerHTML/totalShotsFired.innerHTML*100).toFixed(0);0==p&&0==r?accuracy.innerHTML=0:a<=100?accuracy.innerHTML=a:a>100&&(accuracy.innerHTML=100),ammoCounter.innerHTML=ammoLeft,powerShotsCounter.innerHTML=powerShotAvailabe,displayAmmo.innerHTML=ammoLeft,displayPowerAmmo.innerHTML=powerShotAvailabe,healthCounter.innerHTML=player.health,levelCounter.innerHTML=level;for(var b in x)C(x[b]);e(),playField.drawImage(player,strafeX,0,player.width,player.height,player.PositionValueX,player.PositionValueY,player.width,player.height);for(var c in x){var d=playfieldWidth-player.PositionValueX-(playfieldWidth-x[c].PositionValueX),g=10;d>-g&&d<g&&"Ammo"===x[c].type?(ammoLeft+=10,soundCounter%2==0&&(reload.play(),reload.currentTime=0),delete x[c]):d>-g&&d<g&&"Health"===x[c].type?(healthBar.className="smoothTrans",player.health+=30,soundCounter%2==0&&(healthSound.play(),healthSound.currentTime=0),delete x[c]):d>-g&&d<g&&"PowerShot"===x[c].type&&(powerShotAvailabe+=8,soundCounter%2==0&&(shotgunAmmo.play(),shotgunAmmo.currentTime=0),delete x[c],hitPerLevel=0)}for(var h in shotList)u(shotList[h]);for(var i in shotList)C(shotList[i]);for(var j in powerShotList)u(powerShotList[j]);for(var k in powerShotList)C(powerShotList[k]);v(shotList,bouncingBalls),v(powerShotList,bouncingBalls),0===Object.keys(bouncingBalls).length&&levelComplete===!0&&(infoContainer.style.display="block",statusText.innerHTML="Level complete!",infoContainer.style.backgroundColor=greenColor,buttonText.innerHTML="Next Level",lockPlayer=!0),v(shotList,bouncingBalls),v(powerShotList,bouncingBalls),level>4&&(soundCounter%2==0&&gameCompleteSound.play(),gameCompleteSound.currentTime=0,clearInterval(F),clearInterval(G),a>100&&(a=100),accuracyHS.innerHTML=a,totalShotsFiredHS.innerHTML=totalShotsFired.innerHTML,pistolShotsFiredHS.innerHTML=shotsFired.innerHTML,specialShotsFiredHS.innerHTML=specialShotsFired.innerHTML,collisionCounterHS.innerHTML=collisionCounter.innerHTML,hiddenAccuracy.value=a,hiddenTotalShotsFired.value=totalShotsFired.innerHTML,hiddenPistolShotsFired.value=shotsFired.innerHTML,hiddenSpecialShotsFired.value=specialShotsFired.innerHTML,levelInfo.style.display="none",infoContainer.style.display="block",highscoreSignUpContainer.style.display="block",lockPlayer=!0,restart=!0)}function E(a){a<=0&&(soundCounter%2==0&&(gameOverSound.play(),gameOverSound.currentTime=0),clearInterval(F),clearInterval(G),infoContainer.style.display="block",button.className="gameOverButton",statusText.innerHTML="You died!",infoContainer.style.backgroundColor=redColor,buttonText.innerHTML="Restart",restart=!0,lockPlayer=!0)}introContainer.style.display="none",gameContainer.style.display="block",playFieldBackground.style.background='url("images/'+backGrounds[level-1]+'")',soundController.addEventListener("click",a),setInterval(function(){hit=!1},400),document.onkeydown=function(a){37===a.keyCode&&lockPlayer===!1&&(player.left=!0),39===a.keyCode&&lockPlayer===!1&&(player.right=!0),player.right===!1&&player.left===!1&&(strafeX="pistol"===typeOfShot?260:845),32===a.keyCode&&lockPlayer===!1&&(o(typeOfShot),strafeX="pistol"===typeOfShot?260:845),38===a.keyCode&&("pistol"===typeOfShot?(typeOfShot="shotgun",ammoSelect.style.backgroundColor="#fff",ammoSelectColor.style.color=greenColor,specialAmmoSelect.style.backgroundColor=greenColor,specialAmmoSelectColor.style.color="#fff"):(typeOfShot="pistol",ammoSelectColor.style.color="#fff",ammoSelect.style.backgroundColor=greenColor,specialAmmoSelect.style.backgroundColor="#fff",specialAmmoSelectColor.style.color=greenColor))},document.onkeyup=function(a){37===a.keyCode&&(player.left=!1,strafeX="pistol"==typeOfShot?260:845),39===a.keyCode&&(player.right=!1,strafeX="pistol"==typeOfShot?260:845)};var f=0,g=["#3D4A5D","#1E824C","#D35400"],i=0,p=0,r=0,x={},y=0,F=setInterval(D,20),G=setInterval(function(){if(1===b())for(var a=0;a<level;a++)k(bigBallRadius,100*(Math.floor(9*Math.random())+1),100,ballSpeed,0);timer.innerHTML%10===0&&j<=level?(k(bigBallRadius,100*(Math.floor(9*Math.random())+1),100,ballSpeed,0),j++):timer.innerHTML%ammoGenerate===0&&1!=levelComplete?z(50,50,"Ammo",ammoImage):timer.innerHTML%healthGenerate===0&&player.health<100&&1!=levelComplete&&z(50,50,"Health",healthImage),timer.innerHTML%specialAmmoGenerate===0&&1!=levelComplete&&hitPerLevel>8?z(50,50,"PowerShot",powerAmmoImage):timer.innerHTML%10===0?A():j===level+1&&0===Object.keys(bouncingBalls).length&&(levelComplete=!0)},1e3);setInterval(function(){c()},100)}var playField=document.getElementById("playField").getContext("2d"),redColor="#E74C3C",greenColor="#1BBC9B",gameContainer=document.getElementById("game-container");gameContainer.style.display="none";var introContainer=document.getElementById("intro-container");document.getElementById("startGame").addEventListener("click",startGame);var playfieldHeight=document.getElementById("playField").height,playfieldWidth=document.getElementById("playField").width,infoContainer=document.getElementById("infoContainer"),levelCounter=document.getElementById("level"),accuracy=document.getElementById("accuracy"),totalShotsFired=document.getElementById("totalShotsFired"),specialShotsFired=document.getElementById("specialShotsFired"),collisionCounter=document.getElementById("collisionCounter"),button=document.getElementById("buttonSelector"),buttonText=document.getElementById("buttonText"),levelInfo=document.getElementById("levelInfo"),highscoreSignUpContainer=document.getElementById("highscoreSignUpContainer"),accuracyHS=document.getElementById("accuracyHS"),totalShotsFiredHS=document.getElementById("totalShotsFiredHS"),pistolShotsFiredHS=document.getElementById("pistolShotsFiredHS"),specialShotsFiredHS=document.getElementById("specialShotsFiredHS"),collisionCounterHS=document.getElementById("collisionCounterHS"),hiddenAccuracy=document.getElementById("hiddenAccuracy"),hiddenTotalShotsFired=document.getElementById("hiddenTotalShotsFired"),hiddenSpecialShotsFired=document.getElementById("hiddenSpecialShotsFired"),hiddenPistolShotsFired=document.getElementById("hiddenPistolShotsFired"),healthBar=document.getElementById("health-bar"),healthCounter=document.getElementById("health"),timer=document.getElementById("timer"),ammoSelect=document.getElementById("ammoSelect"),ammoSelectColor=document.getElementById("ammoSelectColor"),displayAmmo=document.getElementById("ammo-info"),ammoImage=document.getElementById("ammoImage"),powerAmmoImage=document.getElementById("powerAmmoImage"),specialAmmoSelectColor=document.getElementById("specialAmmoSelectColor"),displayPowerAmmo=document.getElementById("power-ammo-info");powerAmmoImage.style.display="none",ammoImage.style.display="none";var ballCounter=document.getElementById("ballCounter"),ammoCounter=document.getElementById("ammoCounter"),powerShotsCounter=document.getElementById("powerShotsCounter"),frame=document.getElementById("frame"),backGrounds=["pixelBG2.jpg","fantasy.png","forest.png","desert.png"],playFieldBackground=document.getElementById("playField"),shotsFired=document.getElementById("shotsFired"),healthImage=document.getElementById("healthImage"),shotImage=document.getElementById("shotImage"),specialShotImage=document.getElementById("specialShotImage"),shotList={},powerShotList={},powerShotAvailabe=0,typeOfShot="pistol",ammoLeft=10,bigBallRadius=60,mediumBallRadius=40,smallBallRadius=20,bouncingBalls={},powerUp=!1,restart=!1,lockPlayer=!1,levelComplete=!1,ballSpeed=.2,healthGenerate=12,ammoGenerate=9,specialAmmoGenerate=13,hitPerLevel=0,time=0,frameCount=0,groundHeight=32,level=1,j=0,strafeX=260,soundCounter=0,soundController=document.getElementById("soundController"),toggleSoundText=document.getElementById("toggleSoundText"),pop=new Audio;pop.src="sound/popSound.mp3";var shotSound=new Audio;shotSound.src="sound/pistolShot.mp3";var specialShotSound=new Audio;specialShotSound.src="sound/shotgunShot.mp3";var reload=new Audio;reload.src="sound/reload.wav";var healthSound=new Audio;healthSound.src="sound/getHealth.wav";var damageSound=new Audio;damageSound.src="sound/damageSound.wav";var shotgunAmmo=new Audio;shotgunAmmo.src="sound/shotgunreload.wav";var levelCompleteSound=new Audio;levelCompleteSound.src="sound/nicework.wav";var gameOverSound=new Audio;gameOverSound.src="sound/boo.mp3";var gameCompleteSound=new Audio;gameCompleteSound.src="sound/gameComplete.mp3",ammoSelect.style.backgroundColor=greenColor,healthImage.style.display="none",shotImage.style.display="none",specialShotImage.style.display="none";var player=new Image;player.src="images/villeSprite4.png",player.left=!1,player.right=!1,player.health=100,player.height=75,player.width=65,player.PositionValueX=100,player.PositionValueY=playfieldHeight-75-groundHeight,player.animateX=player.width-25,player.animateY=player.height,button.addEventListener("click",function(){restart===!0?location.reload():(soundCounter%2==0&&(levelCompleteSound.play(),levelCompleteSound.currentTime=0),level++,bouncingBalls={},time=0,j=0,levelComplete=!1,infoContainer.style.display="none",ballSpeed+=.6,healthGenerate+=2,ammoGenerate+=2,specialAmmoGenerate+=2,4==level&&(healthGenerate=14,ammoGenerate=15,specialAmmoGenerate=16),lockPlayer=!1,playFieldBackground.style.background='url("images/'+backGrounds[level-1]+'")',5==level&&(playFieldBackground.style.background='url("images/'+backGrounds[3]+'")'))});
